(()=>{"use strict";const e=(()=>{let e=JSON.parse(localStorage.getItem("toDos"))||[];return{createTodo:(o,n,c,r)=>{let d={name:o,date:n,priority:c,projectName:r};return e.push(d),localStorage.setItem("toDos",JSON.stringify(e)),t.displayProject(),{toDos:e}},attachToProject:(e,o)=>{t.projectList.forEach((t=>{if(o===t){let t;t.push(e),console.log(t)}})),t.projectList.forEach((o=>{t.createProject.e.push(e),console.log(t.createProject.projectArray)}))},toDos:e,updateTodo:(o,n,c,r,d)=>{let a=e.map((function(e){return e.name})).indexOf(o);e[a].name=n,e[a].date=c,e[a].priority=r,e[a].projectName=d,localStorage.setItem("toDos",JSON.stringify(e)),t.displayProject()}}})(),t=(()=>{const t=JSON.parse(localStorage.getItem("projectList"))||["Personal"],n=()=>{const e=document.getElementById("project");e.innerHTML="",t.forEach((t=>{const o=document.createElement("option");o.setAttribute("value",t),o.classList.add("project-option"),o.textContent=t,e.appendChild(o)}))},c=()=>{const n=document.querySelector(".project-container");n.innerHTML="",t.forEach((c=>{const a=c.replace(/\s+/g,"-").toLowerCase(),s=document.createElement("div");s.className=a,s.className="project-div";const l=document.createElement("h2");l.classList.add("project-name");const i=document.createElement("span");i.classList.add("material-symbols-outlined","edit"),i.textContent="edit",i.addEventListener("click",(()=>{r("Edit Project Name","edit project",c)}));const u=document.createElement("button");u.classList.add("add-todo","project-button");const m=document.createElement("span");m.classList.add("material-symbols-outlined","edit"),m.textContent="add",u.append(m,"Add To Do"),u.addEventListener("click",(()=>{o.showForm("Create New Item","todo")})),l.textContent=c,n.appendChild(s),s.appendChild(l),l.appendChild(i),s.appendChild(u),localStorage.setItem("projectList",JSON.stringify(t)),e.toDos.forEach((e=>{if(e.projectName===c){const t=document.createElement("div");t.classList.add("to-do-item");const o=document.createElement("input");o.setAttribute("type","checkbox");const n=document.createElement("span");n.textContent=e.name;const c=document.createElement("span");c.textContent=e.priority;const r=document.createElement("span");r.textContent=e.date;const a=document.createElement("span");a.classList.add("material-symbols-outlined","edit"),a.textContent="edit",a.addEventListener("click",(()=>{d("Edit To Do","edit todo",e)})),s.appendChild(t),t.append(o,n,c,r,a)}}))}));const c=document.createElement("button");c.classList.add("project-button");const a=document.createElement("span");a.classList.add("material-symbols-outlined","edit"),a.textContent="add",c.append(a,"Create New List"),n.appendChild(c),c.addEventListener("click",(()=>{o.showForm("Create New List","project")}))},r=(e,t,n)=>{document.querySelector("#name").value=n,o.showForm(e,t,n)},d=(e,t,n)=>{document.querySelector("#name").value=n.name,document.querySelector("#date").value=n.date,document.querySelector("#priority").value=n.priority,document.querySelector("#project").value=n.projectName,o.showForm(e,t,n.name)};return c(),n(),{createProject:e=>{t.push(e),localStorage.setItem("projectList",JSON.stringify(t)),n(),c()},projectList:t,updateProject:(e,o)=>{console.log(e,o);let r=t.indexOf(e);t[r]=o,localStorage.setItem("projectList",JSON.stringify(t)),c(),n()},displayProject:c}})(),o=(()=>{const o=document.querySelector(".add-todo"),n=document.querySelector("#form-message"),c=document.querySelector(".form-container"),r=document.querySelector(".project-container"),d=document.querySelector(".date"),a=document.querySelector(".priority"),s=document.querySelector(".project-select"),l=document.querySelector(".submit-btn"),i=document.querySelector(".cancel-btn"),u=(d,a,s)=>{o.classList.add("hidden"),r.classList.add("hidden"),n.textContent=d,c.classList.remove("hidden"),l.textContent="Submit",i.textContent="Cancel","todo"===a&&(m(),l.addEventListener("click",(t=>{t.preventDefault(),e.createTodo(document.querySelector("#name").value,document.querySelector("#date").value,document.querySelector("#priority").value,document.querySelector("#project").value),y("todo")}),{once:!0})),"edit todo"===a&&(m(),l.textContent="Update",l.addEventListener("click",(t=>{t.preventDefault(),e.updateTodo(s,document.querySelector("#name").value,document.querySelector("#date").value,document.querySelector("#priority").value,document.querySelector("#project").value),y()}),{once:!0}),i.textContent="Delete",i.addEventListener("click",(o=>{o.preventDefault();let n=e.toDos.map((function(e){return e.name})).indexOf(s);e.toDos.splice(n,1),localStorage.setItem("toDos",JSON.stringify(e.toDos)),t.displayProject(),y()}),{once:!0})),"project"===a&&(p(),l.addEventListener("click",(e=>{e.preventDefault(),t.createProject(document.querySelector("#name").value),y()}),{once:!0})),"edit project"===a&&(p(),l.textContent="Update",l.addEventListener("click",(e=>{e.preventDefault(),t.updateProject(s,document.querySelector("#name").value),y()}),{once:!0}),i.textContent="Delete",i.addEventListener("click",(e=>{e.preventDefault();let o=t.projectList.map((function(e){return e.name})).indexOf(s);t.projectList.splice(o,1),localStorage.setItem("projectList",JSON.stringify(t.projectList)),t.displayProject(),y()}),{once:!0}))},m=()=>{d.classList.remove("hidden"),a.classList.remove("hidden"),s.classList.remove("hidden")},p=()=>{d.classList.add("hidden"),a.classList.add("hidden"),s.classList.add("hidden")},y=()=>{o.classList.remove("hidden"),n.textContent="",c.classList.add("hidden"),r.classList.remove("hidden"),document.querySelector("#priority").selectedIndex=0,document.querySelector("#project").selectedIndex=0;let e=document.querySelectorAll("input");for(let t=0;t<e.length;t++)e[t].value=""};return o.addEventListener("click",(()=>{u("Add To-do","todo")})),{showForm:u,hideForm:y}})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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UUYsT0FKQUssRUFBUXRCLGlCQUFpQixTQUFTLEtBQ2hDTSxFQUFTLFlBQWEsT0FBTyxJQUd4QixDQUFDQSxXQUFVd0IsV0FDbkIsRUFoSHlCLEUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90by1kb3MvLi9zcmMvdG9kb3MuanMiLCJ3ZWJwYWNrOi8vdG8tZG9zLy4vc3JjL3Byb2plY3RzLmpzIiwid2VicGFjazovL3RvLWRvcy8uL3NyYy9idG4tYWN0aW9ucy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBwcm9qZWN0U3R1ZmYgfSBmcm9tIFwiLi9wcm9qZWN0c1wiO1xuaW1wb3J0IHsgYnRuQWN0aW9ucyB9IGZyb20gXCIuL2J0bi1hY3Rpb25zXCI7XG5cbmV4cG9ydCBjb25zdCB0b0RvU3R1ZmYgPSAoKCkgPT4ge1xubGV0IHRvRG9zID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcInRvRG9zXCIpKSB8fCBbXTtcbiAgY29uc3QgY3JlYXRlVG9kbyA9IChuYW1lLCBkYXRlLCBwcmlvcml0eSwgcHJvamVjdE5hbWUpID0+IHtcbiAgIFxuICAgIGxldCB0b0RvID0ge25hbWUsIGRhdGUsIHByaW9yaXR5LCBwcm9qZWN0TmFtZX07XG4gICAgdG9Eb3MucHVzaCh0b0RvKTtcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcInRvRG9zXCIsIEpTT04uc3RyaW5naWZ5KHRvRG9zKSk7XG4gICAgcHJvamVjdFN0dWZmLmRpc3BsYXlQcm9qZWN0KCk7XG4gICAgLy8gYXR0YWNoVG9Qcm9qZWN0KHRvRG8sIHByb2plY3ROYW1lKTtcblxuICAgIHJldHVybiB7dG9Eb3N9O1xuICB9XG5cbiAgY29uc3QgYXR0YWNoVG9Qcm9qZWN0ID0gKHRvRG8sIHByb2plY3ROYW1lKSA9PiB7XG4gICAgcHJvamVjdFN0dWZmLnByb2plY3RMaXN0LmZvckVhY2goKGUpID0+IHtcbiAgICAgIGlmIChwcm9qZWN0TmFtZSA9PT0gZSkge1xuICAgICAgICBsZXQgcHJvamVjdEFycmF5O1xuICAgICAgICBwcm9qZWN0QXJyYXkucHVzaCh0b0RvKTtcbiAgICAgICAgY29uc29sZS5sb2cocHJvamVjdEFycmF5KTtcbiAgICAgICAgLy8gY29uc3QgY2xhc3NOYW1lID0gZS5yZXBsYWNlKC9cXHMrL2csICctJykudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgLy8gY29uc29sZS5sb2coY2xhc3NOYW1lKVxuICAgICAgICAvLyBjb25zdCBwcm9qZWN0TmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYC4ke2NsYXNzTmFtZX1gKTtcbiAgICAgICAgLy8gY29uc3QgdG9Eb0l0ZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG4gICAgICAgIC8vIHRvRG9JdGVtLnRleHRDb250ZW50ID0gdG9Eby5uYW1lO1xuXG4gICAgICAgIC8vIHByb2plY3ROYW1lLmFwcGVuZENoaWxkKHRvRG9JdGVtKTtcbiAgICAgICAgLy8gY29uc29sZS5sb2coZSwgcHJvamVjdE5hbWUpXG4gICAgICB9XG4gICAgfSlcblxuICAgIHByb2plY3RTdHVmZi5wcm9qZWN0TGlzdC5mb3JFYWNoKChlKSA9PiB7XG4gICAgICBpZiAocHJvamVjdE5hbWUgPT09IGUpO1xuICAgICAgcHJvamVjdFN0dWZmLmNyZWF0ZVByb2plY3QuZS5wdXNoKHRvRG8pO1xuICAgICAgICAvLyBlLnB1c2godG9Ebyk7XG4gICAgICAgIGNvbnNvbGUubG9nKHByb2plY3RTdHVmZi5jcmVhdGVQcm9qZWN0LnByb2plY3RBcnJheSk7XG4gICAgfSlcbiAgXG4gIH1cblxuICBjb25zdCB1cGRhdGVUb2RvID0gKGN1cnJlbnQsIG5hbWUsIGRhdGUsIHByaW9yaXR5LCBwcm9qZWN0KSA9PiB7XG4gICAgICBsZXQgaW5kZXggPSB0b0Rvcy5tYXAoZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICByZXR1cm4gZS5uYW1lO1xuICAgICAgfSkuaW5kZXhPZihjdXJyZW50KTtcbiAgICAgICAgdG9Eb3NbaW5kZXhdLm5hbWUgPSBuYW1lO1xuICAgICAgICB0b0Rvc1tpbmRleF0uZGF0ZSA9IGRhdGU7XG4gICAgICAgIHRvRG9zW2luZGV4XS5wcmlvcml0eSA9IHByaW9yaXR5O1xuICAgICAgICB0b0Rvc1tpbmRleF0ucHJvamVjdE5hbWUgPSBwcm9qZWN0O1xuICBcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcInRvRG9zXCIsIEpTT04uc3RyaW5naWZ5KHRvRG9zKSk7XG4gICAgcHJvamVjdFN0dWZmLmRpc3BsYXlQcm9qZWN0KCk7XG4gIH1cblxuICByZXR1cm4geyBjcmVhdGVUb2RvLCBhdHRhY2hUb1Byb2plY3QsIHRvRG9zLCB1cGRhdGVUb2RvIH07XG59KSgpOyIsImltcG9ydCB7IGJ0bkFjdGlvbnMgfSBmcm9tIFwiLi9idG4tYWN0aW9uc1wiO1xuaW1wb3J0IHsgdG9Eb1N0dWZmIH0gZnJvbSBcIi4vdG9kb3NcIjtcblxuZXhwb3J0IGNvbnN0IHByb2plY3RTdHVmZiA9ICgoKSA9PiB7XG4gIC8vIGxvY2FsU3RvcmFnZS5jbGVhcigpO1xuICBjb25zdCBwcm9qZWN0TGlzdCA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJwcm9qZWN0TGlzdFwiKSkgfHwgWydQZXJzb25hbCddO1xuICBcbiAgXG4gIC8vYWRkIHByb2plY3QgdG8gZHJvcC1kb3duXG4gIGNvbnN0IHBvcHVsYXRlUHJvamVjdERyb3BEb3duID0gKCkgPT4ge1xuICAgIGNvbnN0IHByb2plY3RTZWxlY3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJvamVjdCcpO1xuICAgIHByb2plY3RTZWxlY3QuaW5uZXJIVE1MID0gXCJcIjtcbiAgICBwcm9qZWN0TGlzdC5mb3JFYWNoKChlKSA9PiB7XG4gICAgICBjb25zdCBwcm9qZWN0T3B0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnb3B0aW9uJyk7XG4gICAgICBwcm9qZWN0T3B0aW9uLnNldEF0dHJpYnV0ZSgndmFsdWUnLCBlKTtcbiAgICAgIHByb2plY3RPcHRpb24uY2xhc3NMaXN0LmFkZCgncHJvamVjdC1vcHRpb24nKTtcbiAgICAgIHByb2plY3RPcHRpb24udGV4dENvbnRlbnQgPSBlO1xuICAgICAgcHJvamVjdFNlbGVjdC5hcHBlbmRDaGlsZChwcm9qZWN0T3B0aW9uKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8vc2hvdyBwcm9qZWN0IG5hbWUgb24gcGFnZVxuICBjb25zdCBkaXNwbGF5UHJvamVjdCA9ICgpID0+IHtcbiAgICBjb25zdCBwcm9qZWN0Q29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2plY3QtY29udGFpbmVyJyk7XG4gICAgcHJvamVjdENvbnRhaW5lci5pbm5lckhUTUwgPSBcIlwiO1xuICAgIHByb2plY3RMaXN0LmZvckVhY2goKGUpID0+IHtcbiAgICAgIGNvbnN0IGNsYXNzTmFtZSA9IGUucmVwbGFjZSgvXFxzKy9nLCAnLScpLnRvTG93ZXJDYXNlKCk7XG4gICAgICBjb25zdCBwcm9qZWN0RGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICBwcm9qZWN0RGl2LmNsYXNzTmFtZSA9IGNsYXNzTmFtZTtcbiAgICAgIHByb2plY3REaXYuY2xhc3NOYW1lID0gXCJwcm9qZWN0LWRpdlwiO1xuICAgICAgY29uc3QgcHJvamVjdE5hbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoMicpO1xuICAgICAgcHJvamVjdE5hbWUuY2xhc3NMaXN0LmFkZCgncHJvamVjdC1uYW1lJyk7XG4gICAgICBjb25zdCBlZGl0SWNvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICAgIGVkaXRJY29uLmNsYXNzTGlzdC5hZGQgKCdtYXRlcmlhbC1zeW1ib2xzLW91dGxpbmVkJywgJ2VkaXQnKTtcbiAgICAgIGVkaXRJY29uLnRleHRDb250ZW50ID0gJ2VkaXQnO1xuICAgICAgZWRpdEljb24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgIGVkaXRBY3Rpb24oYEVkaXQgUHJvamVjdCBOYW1lYCwgJ2VkaXQgcHJvamVjdCcsIGUpXG4gICAgICB9KTtcblxuICAgICAgLy90b2RvIGJ1dHRvblxuICAgICAgY29uc3QgbmV3VG9kbyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xuICAgICAgbmV3VG9kby5jbGFzc0xpc3QuYWRkKCdhZGQtdG9kbycsICdwcm9qZWN0LWJ1dHRvbicpO1xuICAgICAgXG4gICAgICBjb25zdCBidXR0b25UZXh0VG9kbyA9ICdBZGQgVG8gRG8nXG4gICAgICBjb25zdCBuZXdJY29uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICAgICAgbmV3SWNvbi5jbGFzc0xpc3QuYWRkICgnbWF0ZXJpYWwtc3ltYm9scy1vdXRsaW5lZCcsICdlZGl0Jyk7XG4gICAgICBuZXdJY29uLnRleHRDb250ZW50ID0gJ2FkZCc7XG5cbiAgICAgIG5ld1RvZG8uYXBwZW5kKG5ld0ljb24sIGJ1dHRvblRleHRUb2RvKTtcbiAgICAgIG5ld1RvZG8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgIGJ0bkFjdGlvbnMuc2hvd0Zvcm0oJ0NyZWF0ZSBOZXcgSXRlbScsICd0b2RvJyk7XG4gICAgICB9KTtcblxuICAgICAgcHJvamVjdE5hbWUudGV4dENvbnRlbnQgPSBlO1xuICAgICAgcHJvamVjdENvbnRhaW5lci5hcHBlbmRDaGlsZChwcm9qZWN0RGl2KTtcbiAgICAgIHByb2plY3REaXYuYXBwZW5kQ2hpbGQocHJvamVjdE5hbWUpO1xuICAgICAgcHJvamVjdE5hbWUuYXBwZW5kQ2hpbGQoZWRpdEljb24pO1xuICAgICAgcHJvamVjdERpdi5hcHBlbmRDaGlsZChuZXdUb2RvKTtcblxuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJwcm9qZWN0TGlzdFwiLCBKU09OLnN0cmluZ2lmeShwcm9qZWN0TGlzdCkpO1xuICAgICAgXG4gICAgICB0b0RvU3R1ZmYudG9Eb3MuZm9yRWFjaCgodCkgPT4ge1xuICAgICAgICBpZiAodC5wcm9qZWN0TmFtZSA9PT0gZSkge1xuICAgICAgICAgIGNvbnN0IHRvRG9JdGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgICAgdG9Eb0l0ZW0uY2xhc3NMaXN0LmFkZCgndG8tZG8taXRlbScpO1xuXG4gICAgICAgICAgY29uc3QgY2hlY2tib3ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpXG4gICAgICAgICAgY2hlY2tib3guc2V0QXR0cmlidXRlKFwidHlwZVwiLCBcImNoZWNrYm94XCIpO1xuICAgICAgICAgIGNvbnN0IHRvRG9OYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICAgICAgICAgIHRvRG9OYW1lLnRleHRDb250ZW50ID0gdC5uYW1lO1xuICAgICAgICAgIGNvbnN0IHRvRG9Qcmlvcml0eSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICAgICAgICB0b0RvUHJpb3JpdHkudGV4dENvbnRlbnQgPSB0LnByaW9yaXR5O1xuICAgICAgICAgIGNvbnN0IHRvRG9EYXRlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICAgICAgICAgIHRvRG9EYXRlLnRleHRDb250ZW50ID0gdC5kYXRlO1xuICAgICAgICAgIGNvbnN0IGVkaXRJY29uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICAgICAgICAgIGVkaXRJY29uLmNsYXNzTGlzdC5hZGQgKCdtYXRlcmlhbC1zeW1ib2xzLW91dGxpbmVkJywgJ2VkaXQnKTtcbiAgICAgICAgICBlZGl0SWNvbi50ZXh0Q29udGVudCA9ICdlZGl0JztcbiAgICAgICAgICBlZGl0SWNvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgIGVkaXRUb2RvQWN0aW9uKGBFZGl0IFRvIERvYCwgJ2VkaXQgdG9kbycsIHQpXG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICBwcm9qZWN0RGl2LmFwcGVuZENoaWxkKHRvRG9JdGVtKTtcbiAgICAgICAgICB0b0RvSXRlbS5hcHBlbmQoY2hlY2tib3gsIHRvRG9OYW1lLCB0b0RvUHJpb3JpdHksIHRvRG9EYXRlLCBlZGl0SWNvbik7XG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgfSlcblxuICAgIC8vbmV3IHByb2plY3QgYnV0dG9uXG4gICAgY29uc3QgbmV3UHJvamVjdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xuICAgIG5ld1Byb2plY3QuY2xhc3NMaXN0LmFkZCgncHJvamVjdC1idXR0b24nKTtcbiAgICBcbiAgICBjb25zdCBidXR0b25UZXh0ID0gJ0NyZWF0ZSBOZXcgTGlzdCdcbiAgICBjb25zdCBuZXdJY29uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICAgIG5ld0ljb24uY2xhc3NMaXN0LmFkZCAoJ21hdGVyaWFsLXN5bWJvbHMtb3V0bGluZWQnLCAnZWRpdCcpO1xuICAgIG5ld0ljb24udGV4dENvbnRlbnQgPSAnYWRkJztcblxuICAgIG5ld1Byb2plY3QuYXBwZW5kKG5ld0ljb24sIGJ1dHRvblRleHQpO1xuICAgIHByb2plY3RDb250YWluZXIuYXBwZW5kQ2hpbGQobmV3UHJvamVjdCk7XG4gICAgbmV3UHJvamVjdC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgIGJ0bkFjdGlvbnMuc2hvd0Zvcm0oJ0NyZWF0ZSBOZXcgTGlzdCcsICdwcm9qZWN0Jyk7XG4gICAgfSk7XG4gIH1cblxuICBjb25zdCBlZGl0QWN0aW9uID0gKG1zZywgdHlwZSwgbmFtZSkgPT4ge1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNuYW1lJykudmFsdWUgPSBuYW1lO1xuICAgIGJ0bkFjdGlvbnMuc2hvd0Zvcm0obXNnLCB0eXBlLCBuYW1lKTtcbiAgfVxuXG4gIGNvbnN0IGVkaXRUb2RvQWN0aW9uID0gKG1zZywgdHlwZSwgdG9kbykgPT4ge1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNuYW1lJykudmFsdWUgPSB0b2RvLm5hbWU7XG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2RhdGUnKS52YWx1ZSA9IHRvZG8uZGF0ZTtcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjcHJpb3JpdHknKS52YWx1ZSA9IHRvZG8ucHJpb3JpdHk7XG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3Byb2plY3QnKS52YWx1ZSA9IHRvZG8ucHJvamVjdE5hbWU7XG4gICAgYnRuQWN0aW9ucy5zaG93Rm9ybShtc2csIHR5cGUsIHRvZG8ubmFtZSk7XG4gIH1cblxuICAvL3Byb2plY3QgZmFjdG9yeSBmdW5jdGlvblxuICBjb25zdCBjcmVhdGVQcm9qZWN0ID0gKG5hbWUpID0+IHtcbiAgICBwcm9qZWN0TGlzdC5wdXNoKG5hbWUpO1xuICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwicHJvamVjdExpc3RcIiwgSlNPTi5zdHJpbmdpZnkocHJvamVjdExpc3QpKTtcblxuICAgIHBvcHVsYXRlUHJvamVjdERyb3BEb3duKCk7XG4gICAgZGlzcGxheVByb2plY3QoKTtcbiAgICAvLyBjcmVhdGVQcm9qZWN0QXJyYXkoKTtcbiAgfVxuXG4gIGNvbnN0IHVwZGF0ZVByb2plY3QgPSAoY3VycmVudE5hbWUsIG5ld05hbWUpID0+IHtcbiAgICBjb25zb2xlLmxvZyhjdXJyZW50TmFtZSwgbmV3TmFtZSk7XG4gICAgbGV0IGluZGV4ID0gcHJvamVjdExpc3QuaW5kZXhPZihjdXJyZW50TmFtZSk7XG4gICAgcHJvamVjdExpc3RbaW5kZXhdID0gbmV3TmFtZTtcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcInByb2plY3RMaXN0XCIsIEpTT04uc3RyaW5naWZ5KHByb2plY3RMaXN0KSk7XG4gICAgZGlzcGxheVByb2plY3QoKTtcbiAgICBwb3B1bGF0ZVByb2plY3REcm9wRG93bigpO1xuICB9XG4gICAgICBcbiAgZGlzcGxheVByb2plY3QoKTtcbiAgcG9wdWxhdGVQcm9qZWN0RHJvcERvd24oKTtcbiAgXG4gIHJldHVybiB7Y3JlYXRlUHJvamVjdCwgcHJvamVjdExpc3QsIHVwZGF0ZVByb2plY3QsIGRpc3BsYXlQcm9qZWN0fVxufSkoKTsiLCJpbXBvcnQgeyBwcm9qZWN0U3R1ZmYgfSBmcm9tIFwiLi9wcm9qZWN0c1wiO1xuaW1wb3J0IHsgdG9Eb1N0dWZmIH0gZnJvbSBcIi4vdG9kb3NcIjtcblxuZXhwb3J0IGNvbnN0IGJ0bkFjdGlvbnMgPSAoKCkgPT4ge1xuICBjb25zdCB0b2RvQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFkZC10b2RvJyk7XG4gIGNvbnN0IGZvcm1NZXNzYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2Zvcm0tbWVzc2FnZScpO1xuICBjb25zdCBmb3JtQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmZvcm0tY29udGFpbmVyJyk7XG4gIGNvbnN0IHByb2plY3RDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvamVjdC1jb250YWluZXInKTtcbiAgXG4gIGNvbnN0IGRhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZGF0ZScpO1xuICBjb25zdCBwcmlvcml0eSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcmlvcml0eScpO1xuICBjb25zdCBwcm9qZWN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2plY3Qtc2VsZWN0Jyk7XG4gIGNvbnN0IHN1Ym1pdEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zdWJtaXQtYnRuJyk7XG4gIGNvbnN0IGNhbmNlbEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYW5jZWwtYnRuJyk7XG5cbiAgY29uc3Qgc2hvd0Zvcm0gPSAobXNnLCB0eXBlLCBjdXJyZW50KSA9PiB7XG4gICAgdG9kb0J0bi5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTtcbiAgICBwcm9qZWN0Q29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpO1xuICAgIGZvcm1NZXNzYWdlLnRleHRDb250ZW50ID0gbXNnO1xuICAgIGZvcm1Db250YWluZXIuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7XG4gICAgc3VibWl0QnRuLnRleHRDb250ZW50ID0gXCJTdWJtaXRcIjtcbiAgICBjYW5jZWxCdG4udGV4dENvbnRlbnQgPSBcIkNhbmNlbFwiO1xuICAgIGlmICh0eXBlID09PSAndG9kbycpIHtcbiAgICAgIHNob3dGb3JtSW5wdXRzKCk7XG4gICAgICBzdWJtaXRCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIHRvRG9TdHVmZi5jcmVhdGVUb2RvKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNuYW1lJykudmFsdWUsIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNkYXRlJykudmFsdWUsIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNwcmlvcml0eScpLnZhbHVlLCBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjcHJvamVjdCcpLnZhbHVlKTtcbiAgICAgICAgaGlkZUZvcm0oJ3RvZG8nKTtcbiAgICAgIH0sIHtvbmNlOiB0cnVlfSlcbiAgICB9IGlmICh0eXBlID09PSAnZWRpdCB0b2RvJykge1xuICAgICAgc2hvd0Zvcm1JbnB1dHMoKTtcbiAgICAgIHN1Ym1pdEJ0bi50ZXh0Q29udGVudCA9IFwiVXBkYXRlXCI7XG4gICAgICBzdWJtaXRCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIC8vdXBkYXRlIHRvZG8gaXRlbVxuICAgICAgICB0b0RvU3R1ZmYudXBkYXRlVG9kbyhjdXJyZW50LCBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbmFtZScpLnZhbHVlLCBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjZGF0ZScpLnZhbHVlLCBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjcHJpb3JpdHknKS52YWx1ZSwgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3Byb2plY3QnKS52YWx1ZSk7XG4gICAgICAgIGhpZGVGb3JtKCk7XG4gICAgICB9LCB7b25jZTogdHJ1ZX0pO1xuXG4gICAgICBjYW5jZWxCdG4udGV4dENvbnRlbnQgPSBcIkRlbGV0ZVwiO1xuICAgICAgY2FuY2VsQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAvL2RlbGV0ZSB0b2RvIGl0ZW1cbiAgICAgICAgbGV0IGluZGV4ID0gdG9Eb1N0dWZmLnRvRG9zLm1hcChmdW5jdGlvbiAoZSkge1xuICAgICAgICAgIHJldHVybiBlLm5hbWU7XG4gICAgICAgIH0pLmluZGV4T2YoY3VycmVudCk7XG4gICAgICAgIHRvRG9TdHVmZi50b0Rvcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcInRvRG9zXCIsIEpTT04uc3RyaW5naWZ5KHRvRG9TdHVmZi50b0RvcykpO1xuICAgICAgICBwcm9qZWN0U3R1ZmYuZGlzcGxheVByb2plY3QoKTtcbiAgICAgICAgaGlkZUZvcm0oKTtcbiAgICAgIH0sIHtvbmNlOiB0cnVlfSk7XG4gICAgfSBpZiAodHlwZSA9PT0gJ3Byb2plY3QnKSB7XG4gICAgICBoaWRlRm9ybUlucHV0cygpO1xuICAgICAgc3VibWl0QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBwcm9qZWN0U3R1ZmYuY3JlYXRlUHJvamVjdChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbmFtZScpLnZhbHVlKTtcbiAgICAgICAgaGlkZUZvcm0oKTtcbiAgICAgIH0sIHtvbmNlOiB0cnVlfSk7XG4gICAgfSBpZiAodHlwZSA9PT0gJ2VkaXQgcHJvamVjdCcpIHtcbiAgICAgIGhpZGVGb3JtSW5wdXRzKCk7XG4gICAgICBzdWJtaXRCdG4udGV4dENvbnRlbnQgPSBcIlVwZGF0ZVwiO1xuICAgICAgc3VibWl0QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBwcm9qZWN0U3R1ZmYudXBkYXRlUHJvamVjdChjdXJyZW50LCBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbmFtZScpLnZhbHVlKTtcbiAgICAgICAgaGlkZUZvcm0oKTtcbiAgICAgIH0sIHtvbmNlOiB0cnVlfSk7XG5cbiAgICAgIGNhbmNlbEJ0bi50ZXh0Q29udGVudCA9IFwiRGVsZXRlXCI7XG4gICAgICBjYW5jZWxCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIC8vZGVsZXRlIHRvZG8gaXRlbVxuICAgICAgICBsZXQgaW5kZXggPSBwcm9qZWN0U3R1ZmYucHJvamVjdExpc3QubWFwKGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgcmV0dXJuIGUubmFtZTtcbiAgICAgICAgfSkuaW5kZXhPZihjdXJyZW50KTtcbiAgICAgICAgcHJvamVjdFN0dWZmLnByb2plY3RMaXN0LnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwicHJvamVjdExpc3RcIiwgSlNPTi5zdHJpbmdpZnkocHJvamVjdFN0dWZmLnByb2plY3RMaXN0KSk7XG4gICAgICAgIHByb2plY3RTdHVmZi5kaXNwbGF5UHJvamVjdCgpO1xuICAgICAgICBoaWRlRm9ybSgpO1xuICAgICAgfSwge29uY2U6IHRydWV9KTtcbiAgICB9XG4gIH1cblxuICBjb25zdCBzaG93Rm9ybUlucHV0cyA9ICgpID0+IHtcbiAgICBkYXRlLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpO1xuICAgIHByaW9yaXR5LmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpO1xuICAgIHByb2plY3QuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7XG4gIH1cblxuICBjb25zdCBoaWRlRm9ybUlucHV0cyA9ICgpID0+IHtcbiAgICBkYXRlLmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpO1xuICAgIHByaW9yaXR5LmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpO1xuICAgIHByb2plY3QuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7XG4gIH1cblxuICBjb25zdCBoaWRlRm9ybSA9ICgpID0+IHtcbiAgICB0b2RvQnRuLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpO1xuICAgIGZvcm1NZXNzYWdlLnRleHRDb250ZW50ID0gXCJcIjtcbiAgICBmb3JtQ29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpO1xuICAgIHByb2plY3RDb250YWluZXIuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7XG4gICAgLy9yZXNldCBwcmlvcml0eSBhbmQgcHJvamVjdFxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNwcmlvcml0eScpLnNlbGVjdGVkSW5kZXggPSAwO1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNwcm9qZWN0Jykuc2VsZWN0ZWRJbmRleCA9IDA7XG4gICAgLy9yZXNldCBpbnB1dHNcbiAgICBsZXQgaW5wdXRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnaW5wdXQnKTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGlucHV0cy5sZW5ndGg7IGkrKykge1xuICAgICAgaW5wdXRzW2ldLnZhbHVlID0gXCJcIjtcbiAgICB9XG4gIH1cblxuICAvL2FkZCB0b2RvIGJ1dHRvbiBzaG93IGZvcm1cbiAgdG9kb0J0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICBzaG93Rm9ybSgnQWRkIFRvLWRvJywgJ3RvZG8nKTtcbiAgfSk7XG4gIFxuICByZXR1cm4ge3Nob3dGb3JtLCBoaWRlRm9ybX1cbn0pKCk7XG5cbiAgIl0sIm5hbWVzIjpbInRvRG9TdHVmZiIsInRvRG9zIiwiSlNPTiIsInBhcnNlIiwibG9jYWxTdG9yYWdlIiwiZ2V0SXRlbSIsImNyZWF0ZVRvZG8iLCJuYW1lIiwiZGF0ZSIsInByaW9yaXR5IiwicHJvamVjdE5hbWUiLCJ0b0RvIiwicHVzaCIsInNldEl0ZW0iLCJzdHJpbmdpZnkiLCJwcm9qZWN0U3R1ZmYiLCJkaXNwbGF5UHJvamVjdCIsImF0dGFjaFRvUHJvamVjdCIsInByb2plY3RMaXN0IiwiZm9yRWFjaCIsImUiLCJwcm9qZWN0QXJyYXkiLCJjb25zb2xlIiwibG9nIiwiY3JlYXRlUHJvamVjdCIsInVwZGF0ZVRvZG8iLCJjdXJyZW50IiwicHJvamVjdCIsImluZGV4IiwibWFwIiwiaW5kZXhPZiIsInBvcHVsYXRlUHJvamVjdERyb3BEb3duIiwicHJvamVjdFNlbGVjdCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJpbm5lckhUTUwiLCJwcm9qZWN0T3B0aW9uIiwiY3JlYXRlRWxlbWVudCIsInNldEF0dHJpYnV0ZSIsImNsYXNzTGlzdCIsImFkZCIsInRleHRDb250ZW50IiwiYXBwZW5kQ2hpbGQiLCJwcm9qZWN0Q29udGFpbmVyIiwicXVlcnlTZWxlY3RvciIsImNsYXNzTmFtZSIsInJlcGxhY2UiLCJ0b0xvd2VyQ2FzZSIsInByb2plY3REaXYiLCJlZGl0SWNvbiIsImFkZEV2ZW50TGlzdGVuZXIiLCJlZGl0QWN0aW9uIiwibmV3VG9kbyIsIm5ld0ljb24iLCJhcHBlbmQiLCJidG5BY3Rpb25zIiwic2hvd0Zvcm0iLCJ0IiwidG9Eb0l0ZW0iLCJjaGVja2JveCIsInRvRG9OYW1lIiwidG9Eb1ByaW9yaXR5IiwidG9Eb0RhdGUiLCJlZGl0VG9kb0FjdGlvbiIsIm5ld1Byb2plY3QiLCJtc2ciLCJ0eXBlIiwidmFsdWUiLCJ0b2RvIiwidXBkYXRlUHJvamVjdCIsImN1cnJlbnROYW1lIiwibmV3TmFtZSIsInRvZG9CdG4iLCJmb3JtTWVzc2FnZSIsImZvcm1Db250YWluZXIiLCJzdWJtaXRCdG4iLCJjYW5jZWxCdG4iLCJyZW1vdmUiLCJzaG93Rm9ybUlucHV0cyIsInByZXZlbnREZWZhdWx0IiwiaGlkZUZvcm0iLCJvbmNlIiwic3BsaWNlIiwiaGlkZUZvcm1JbnB1dHMiLCJzZWxlY3RlZEluZGV4IiwiaW5wdXRzIiwicXVlcnlTZWxlY3RvckFsbCIsImkiLCJsZW5ndGgiXSwic291cmNlUm9vdCI6IiJ9