(()=>{"use strict";const e=(()=>{let e=JSON.parse(localStorage.getItem("toDos"))||[];return{createTodo:(o,c,n,r)=>{let d={name:o,date:c,priority:n,projectName:r};return e.push(d),localStorage.setItem("toDos",JSON.stringify(e)),t.displayProject(),{toDos:e}},attachToProject:(e,o)=>{t.projectList.forEach((t=>{if(o===t){let t;t.push(e)}})),t.projectList.forEach((o=>{t.createProject.e.push(e)}))},toDos:e,updateTodo:(o,c,n,r,d)=>{let a=e.map((function(e){return e.name})).indexOf(o);e[a].name=c,e[a].date=n,e[a].priority=r,e[a].projectName=d,localStorage.setItem("toDos",JSON.stringify(e)),t.displayProject()}}})(),t=(()=>{const t=JSON.parse(localStorage.getItem("projectList"))||["Personal"],c=()=>{const e=document.getElementById("project");e.innerHTML="",t.forEach((t=>{const o=document.createElement("option");o.setAttribute("value",t),o.classList.add("project-option"),o.textContent=t,e.appendChild(o)}))},n=()=>{const c=document.querySelector(".project-container");c.innerHTML="",t.forEach((n=>{const a=document.createElement("div");a.dataset.project=n.replace(/\s+/g,"-").toLowerCase(),a.className="project-div";const s=document.createElement("h2");s.classList.add("project-name");const l=document.createElement("span");l.classList.add("material-symbols-outlined","edit"),l.textContent="edit",l.addEventListener("click",(()=>{r("Edit Project Name","edit project",n)}));const i=document.createElement("button");i.classList.add("add-todo","project-button");const u=document.createElement("span");u.classList.add("material-symbols-outlined","edit"),u.textContent="add",i.append(u,"Add To Do"),i.addEventListener("click",(()=>{o.showForm("Create New Item","todo",n)})),s.textContent=n,c.appendChild(a),a.appendChild(s),s.appendChild(l),a.appendChild(i),localStorage.setItem("projectList",JSON.stringify(t)),e.toDos.forEach((e=>{if(e.projectName===n){const t=document.createElement("div");t.classList.add("to-do-item");const o=document.createElement("input");o.setAttribute("type","checkbox");const c=document.createElement("span");c.textContent=e.name;const n=document.createElement("span");n.textContent=e.priority;const r=document.createElement("span");r.textContent=e.date;const s=document.createElement("span");s.classList.add("material-symbols-outlined","edit"),s.textContent="edit",s.addEventListener("click",(()=>{d("Edit To Do","edit todo",e)})),a.appendChild(t),t.append(o,c,n,r,s)}}))}));const n=document.createElement("button");n.classList.add("project-button");const a=document.createElement("span");a.classList.add("material-symbols-outlined","edit"),a.textContent="add",n.append(a,"Create New List"),c.appendChild(n),n.addEventListener("click",(()=>{o.showForm("Create New List","project")}))},r=(e,t,c)=>{document.querySelector("#name").value=c,o.showForm(e,t,c)},d=(e,t,c)=>{document.querySelector("#name").value=c.name,document.querySelector("#date").value=c.date,document.querySelector("#priority").value=c.priority,document.querySelector("#project").value=c.projectName,o.showForm(e,t,c.name)};return n(),c(),{createProject:e=>{t.push(e),localStorage.setItem("projectList",JSON.stringify(t)),c(),n()},projectList:t,updateProject:(e,o)=>{let r=t.indexOf(e);t[r]=o,localStorage.setItem("projectList",JSON.stringify(t)),n(),c()},displayProject:n}})(),o=(()=>{const o=document.querySelector(".add-todo"),c=document.querySelector("#form-message"),n=document.querySelector(".form-container"),r=document.querySelector(".project-container"),d=document.querySelector(".date"),a=document.querySelector(".priority"),s=document.querySelector(".project-select"),l=document.querySelector(".submit-btn"),i=document.querySelector(".cancel-btn"),u=()=>{d.classList.remove("hidden"),a.classList.remove("hidden"),s.classList.remove("hidden")},m=()=>{d.classList.add("hidden"),a.classList.add("hidden"),s.classList.add("hidden")},p=()=>{o.classList.remove("hidden"),c.textContent="",n.classList.add("hidden"),r.classList.remove("hidden"),document.querySelector("#priority").selectedIndex=0,document.querySelector("#project").selectedIndex=0;let e=document.querySelectorAll("input");for(let t=0;t<e.length;t++)e[t].value=""};return{showForm:(d,a,s)=>{if(o.classList.add("hidden"),r.classList.add("hidden"),c.textContent=d,n.classList.remove("hidden"),l.textContent="Submit",i.textContent="Cancel","todo"===a){u();const o=t.projectList.indexOf(s);document.querySelector("#project").value=t.projectList[o],l.addEventListener("click",(t=>{e.toDos.includes(document.querySelector("#name"))&&(t.preventDefault(),e.createTodo(document.querySelector("#name").value,document.querySelector("#date").value,document.querySelector("#priority").value,document.querySelector("#project").value),p())}),{once:!0})}"edit todo"===a&&(u(),l.textContent="Update",l.addEventListener("click",(t=>{t.preventDefault(),e.updateTodo(s,document.querySelector("#name").value,document.querySelector("#date").value,document.querySelector("#priority").value,document.querySelector("#project").value),p()}),{once:!0}),i.textContent="Delete",i.addEventListener("click",(o=>{o.preventDefault();let c=e.toDos.map((function(e){return e.name})).indexOf(s);e.toDos.splice(c,1),localStorage.setItem("toDos",JSON.stringify(e.toDos)),t.displayProject(),p()}),{once:!0})),"project"===a&&(m(),l.addEventListener("click",(e=>{console.log(!t.projectList.includes(document.querySelector("#name").value)),e.preventDefault(),t.projectList.includes(document.querySelector("#name").value)?console.log("error"):(t.createProject(document.querySelector("#name").value),p())}))),"edit project"===a&&(m(),l.textContent="Update",l.addEventListener("click",(e=>{e.preventDefault(),t.updateProject(s,document.querySelector("#name").value),p()}),{once:!0}),i.textContent="Delete",i.addEventListener("click",(e=>{e.preventDefault();let o=t.projectList.indexOf(s);t.projectList.splice(o,1),localStorage.setItem("projectList",JSON.stringify(t.projectList)),t.displayProject(),p()}),{once:!0}))},hideForm:p}})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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VSxRQUFRSixHQUM3Q1QsRUFBYUcsWUFBWXVFLE9BQU8vRCxFQUFPLEdBQ3ZDdEIsYUFBYVMsUUFBUSxjQUFlWCxLQUFLWSxVQUFVQyxFQUFhRyxjQUNoRUgsRUFBYUMsaUJBQ2IrRCxHQUFVLEdBQ1QsQ0FBQ1MsTUFBTSxJQUNaLEVBOEJnQlQsV0FDbkIsRUEvSHlCLEUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly90by1kb3MvLi9zcmMvdG9kb3MuanMiLCJ3ZWJwYWNrOi8vdG8tZG9zLy4vc3JjL3Byb2plY3RzLmpzIiwid2VicGFjazovL3RvLWRvcy8uL3NyYy9idG4tYWN0aW9ucy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBwcm9qZWN0U3R1ZmYgfSBmcm9tIFwiLi9wcm9qZWN0c1wiO1xuaW1wb3J0IHsgYnRuQWN0aW9ucyB9IGZyb20gXCIuL2J0bi1hY3Rpb25zXCI7XG5cbmV4cG9ydCBjb25zdCB0b0RvU3R1ZmYgPSAoKCkgPT4ge1xuICAvLyBsb2NhbFN0b3JhZ2UuY2xlYXIoKTtcbmxldCB0b0RvcyA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJ0b0Rvc1wiKSkgfHwgW107XG4gIGNvbnN0IGNyZWF0ZVRvZG8gPSAobmFtZSwgZGF0ZSwgcHJpb3JpdHksIHByb2plY3ROYW1lKSA9PiB7XG4gICBcbiAgICBsZXQgdG9EbyA9IHtuYW1lLCBkYXRlLCBwcmlvcml0eSwgcHJvamVjdE5hbWV9O1xuICAgIHRvRG9zLnB1c2godG9Ebyk7XG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJ0b0Rvc1wiLCBKU09OLnN0cmluZ2lmeSh0b0RvcykpO1xuICAgIHByb2plY3RTdHVmZi5kaXNwbGF5UHJvamVjdCgpO1xuICAgIC8vIGF0dGFjaFRvUHJvamVjdCh0b0RvLCBwcm9qZWN0TmFtZSk7XG5cbiAgICByZXR1cm4ge3RvRG9zfTtcbiAgfVxuXG4gIGNvbnN0IGF0dGFjaFRvUHJvamVjdCA9ICh0b0RvLCBwcm9qZWN0TmFtZSkgPT4ge1xuICAgIHByb2plY3RTdHVmZi5wcm9qZWN0TGlzdC5mb3JFYWNoKChlKSA9PiB7XG4gICAgICBpZiAocHJvamVjdE5hbWUgPT09IGUpIHtcbiAgICAgICAgbGV0IHByb2plY3RBcnJheTtcbiAgICAgICAgcHJvamVjdEFycmF5LnB1c2godG9Ebyk7XG4gICAgICAgIC8vIGNvbnN0IGNsYXNzTmFtZSA9IGUucmVwbGFjZSgvXFxzKy9nLCAnLScpLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKGNsYXNzTmFtZSlcbiAgICAgICAgLy8gY29uc3QgcHJvamVjdE5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAuJHtjbGFzc05hbWV9YCk7XG4gICAgICAgIC8vIGNvbnN0IHRvRG9JdGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xuICAgICAgICAvLyB0b0RvSXRlbS50ZXh0Q29udGVudCA9IHRvRG8ubmFtZTtcblxuICAgICAgICAvLyBwcm9qZWN0TmFtZS5hcHBlbmRDaGlsZCh0b0RvSXRlbSk7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKGUsIHByb2plY3ROYW1lKVxuICAgICAgfVxuICAgIH0pXG5cbiAgICBwcm9qZWN0U3R1ZmYucHJvamVjdExpc3QuZm9yRWFjaCgoZSkgPT4ge1xuICAgICAgaWYgKHByb2plY3ROYW1lID09PSBlKTtcbiAgICAgIHByb2plY3RTdHVmZi5jcmVhdGVQcm9qZWN0LmUucHVzaCh0b0RvKTtcbiAgICAgICAgLy8gZS5wdXNoKHRvRG8pO1xuICAgIH0pXG4gIFxuICB9XG5cbiAgY29uc3QgdXBkYXRlVG9kbyA9IChjdXJyZW50LCBuYW1lLCBkYXRlLCBwcmlvcml0eSwgcHJvamVjdCkgPT4ge1xuICAgICAgbGV0IGluZGV4ID0gdG9Eb3MubWFwKGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgcmV0dXJuIGUubmFtZTtcbiAgICAgIH0pLmluZGV4T2YoY3VycmVudCk7XG4gICAgICAgIHRvRG9zW2luZGV4XS5uYW1lID0gbmFtZTtcbiAgICAgICAgdG9Eb3NbaW5kZXhdLmRhdGUgPSBkYXRlO1xuICAgICAgICB0b0Rvc1tpbmRleF0ucHJpb3JpdHkgPSBwcmlvcml0eTtcbiAgICAgICAgdG9Eb3NbaW5kZXhdLnByb2plY3ROYW1lID0gcHJvamVjdDtcbiAgXG4gICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oXCJ0b0Rvc1wiLCBKU09OLnN0cmluZ2lmeSh0b0RvcykpO1xuICAgIHByb2plY3RTdHVmZi5kaXNwbGF5UHJvamVjdCgpO1xuICB9XG5cbiAgcmV0dXJuIHsgY3JlYXRlVG9kbywgYXR0YWNoVG9Qcm9qZWN0LCB0b0RvcywgdXBkYXRlVG9kbyB9O1xufSkoKTsiLCJpbXBvcnQgeyBidG5BY3Rpb25zIH0gZnJvbSBcIi4vYnRuLWFjdGlvbnNcIjtcbmltcG9ydCB7IHRvRG9TdHVmZiB9IGZyb20gXCIuL3RvZG9zXCI7XG5cbmV4cG9ydCBjb25zdCBwcm9qZWN0U3R1ZmYgPSAoKCkgPT4ge1xuICAvLyBsb2NhbFN0b3JhZ2UuY2xlYXIoKTtcbiAgY29uc3QgcHJvamVjdExpc3QgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwicHJvamVjdExpc3RcIikpIHx8IFsnUGVyc29uYWwnXTtcbiAgXG4gIFxuICAvL2FkZCBwcm9qZWN0IHRvIGRyb3AtZG93blxuICBjb25zdCBwb3B1bGF0ZVByb2plY3REcm9wRG93biA9ICgpID0+IHtcbiAgICBjb25zdCBwcm9qZWN0U2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Byb2plY3QnKTtcbiAgICBwcm9qZWN0U2VsZWN0LmlubmVySFRNTCA9IFwiXCI7XG4gICAgcHJvamVjdExpc3QuZm9yRWFjaCgoZSkgPT4ge1xuICAgICAgY29uc3QgcHJvamVjdE9wdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29wdGlvbicpO1xuICAgICAgcHJvamVjdE9wdGlvbi5zZXRBdHRyaWJ1dGUoJ3ZhbHVlJywgZSk7XG4gICAgICBwcm9qZWN0T3B0aW9uLmNsYXNzTGlzdC5hZGQoJ3Byb2plY3Qtb3B0aW9uJyk7XG4gICAgICBwcm9qZWN0T3B0aW9uLnRleHRDb250ZW50ID0gZTtcbiAgICAgIHByb2plY3RTZWxlY3QuYXBwZW5kQ2hpbGQocHJvamVjdE9wdGlvbik7XG4gICAgfSk7XG4gIH1cblxuICAvL3Nob3cgcHJvamVjdCBuYW1lIG9uIHBhZ2VcbiAgY29uc3QgZGlzcGxheVByb2plY3QgPSAoKSA9PiB7XG4gICAgY29uc3QgcHJvamVjdENvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9qZWN0LWNvbnRhaW5lcicpO1xuICAgIHByb2plY3RDb250YWluZXIuaW5uZXJIVE1MID0gXCJcIjtcbiAgICBwcm9qZWN0TGlzdC5mb3JFYWNoKChlKSA9PiB7XG4gICAgICBjb25zdCBwcm9qZWN0RGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICBwcm9qZWN0RGl2LmRhdGFzZXQucHJvamVjdCA9IGUucmVwbGFjZSgvXFxzKy9nLCAnLScpLnRvTG93ZXJDYXNlKCk7XG4gICAgICBwcm9qZWN0RGl2LmNsYXNzTmFtZSA9IFwicHJvamVjdC1kaXZcIjtcbiAgICAgIGNvbnN0IHByb2plY3ROYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDInKTtcbiAgICAgIHByb2plY3ROYW1lLmNsYXNzTGlzdC5hZGQoJ3Byb2plY3QtbmFtZScpO1xuICAgICAgY29uc3QgZWRpdEljb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgICBlZGl0SWNvbi5jbGFzc0xpc3QuYWRkICgnbWF0ZXJpYWwtc3ltYm9scy1vdXRsaW5lZCcsICdlZGl0Jyk7XG4gICAgICBlZGl0SWNvbi50ZXh0Q29udGVudCA9ICdlZGl0JztcbiAgICAgIGVkaXRJY29uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICBlZGl0QWN0aW9uKGBFZGl0IFByb2plY3QgTmFtZWAsICdlZGl0IHByb2plY3QnLCBlKVxuICAgICAgfSk7XG5cbiAgICAgIC8vdG9kbyBidXR0b25cbiAgICAgIGNvbnN0IG5ld1RvZG8gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcbiAgICAgIG5ld1RvZG8uY2xhc3NMaXN0LmFkZCgnYWRkLXRvZG8nLCAncHJvamVjdC1idXR0b24nKTtcbiAgICAgIFxuICAgICAgY29uc3QgYnV0dG9uVGV4dFRvZG8gPSAnQWRkIFRvIERvJ1xuICAgICAgY29uc3QgbmV3SWNvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICAgIG5ld0ljb24uY2xhc3NMaXN0LmFkZCAoJ21hdGVyaWFsLXN5bWJvbHMtb3V0bGluZWQnLCAnZWRpdCcpO1xuICAgICAgbmV3SWNvbi50ZXh0Q29udGVudCA9ICdhZGQnO1xuXG4gICAgICBuZXdUb2RvLmFwcGVuZChuZXdJY29uLCBidXR0b25UZXh0VG9kbyk7XG4gICAgICBuZXdUb2RvLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICBidG5BY3Rpb25zLnNob3dGb3JtKCdDcmVhdGUgTmV3IEl0ZW0nLCAndG9kbycsIGUpO1xuICAgICAgfSk7XG5cbiAgICAgIHByb2plY3ROYW1lLnRleHRDb250ZW50ID0gZTtcbiAgICAgIHByb2plY3RDb250YWluZXIuYXBwZW5kQ2hpbGQocHJvamVjdERpdik7XG4gICAgICBwcm9qZWN0RGl2LmFwcGVuZENoaWxkKHByb2plY3ROYW1lKTtcbiAgICAgIHByb2plY3ROYW1lLmFwcGVuZENoaWxkKGVkaXRJY29uKTtcbiAgICAgIHByb2plY3REaXYuYXBwZW5kQ2hpbGQobmV3VG9kbyk7XG5cbiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwicHJvamVjdExpc3RcIiwgSlNPTi5zdHJpbmdpZnkocHJvamVjdExpc3QpKTtcbiAgICAgIFxuICAgICAgdG9Eb1N0dWZmLnRvRG9zLmZvckVhY2goKHQpID0+IHtcbiAgICAgICAgaWYgKHQucHJvamVjdE5hbWUgPT09IGUpIHtcbiAgICAgICAgICBjb25zdCB0b0RvSXRlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICAgIHRvRG9JdGVtLmNsYXNzTGlzdC5hZGQoJ3RvLWRvLWl0ZW0nKTtcblxuICAgICAgICAgIGNvbnN0IGNoZWNrYm94ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKVxuICAgICAgICAgIGNoZWNrYm94LnNldEF0dHJpYnV0ZShcInR5cGVcIiwgXCJjaGVja2JveFwiKTtcbiAgICAgICAgICBjb25zdCB0b0RvTmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICAgICAgICB0b0RvTmFtZS50ZXh0Q29udGVudCA9IHQubmFtZTtcbiAgICAgICAgICBjb25zdCB0b0RvUHJpb3JpdHkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgICAgICAgdG9Eb1ByaW9yaXR5LnRleHRDb250ZW50ID0gdC5wcmlvcml0eTtcbiAgICAgICAgICBjb25zdCB0b0RvRGF0ZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICAgICAgICB0b0RvRGF0ZS50ZXh0Q29udGVudCA9IHQuZGF0ZTtcbiAgICAgICAgICBjb25zdCBlZGl0SWNvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICAgICAgICBlZGl0SWNvbi5jbGFzc0xpc3QuYWRkICgnbWF0ZXJpYWwtc3ltYm9scy1vdXRsaW5lZCcsICdlZGl0Jyk7XG4gICAgICAgICAgZWRpdEljb24udGV4dENvbnRlbnQgPSAnZWRpdCc7XG4gICAgICAgICAgZWRpdEljb24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICBlZGl0VG9kb0FjdGlvbihgRWRpdCBUbyBEb2AsICdlZGl0IHRvZG8nLCB0KVxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgcHJvamVjdERpdi5hcHBlbmRDaGlsZCh0b0RvSXRlbSk7XG4gICAgICAgICAgdG9Eb0l0ZW0uYXBwZW5kKGNoZWNrYm94LCB0b0RvTmFtZSwgdG9Eb1ByaW9yaXR5LCB0b0RvRGF0ZSwgZWRpdEljb24pO1xuICAgICAgICB9XG4gICAgICB9KVxuICAgIH0pXG5cbiAgICAvL25ldyBwcm9qZWN0IGJ1dHRvblxuICAgIGNvbnN0IG5ld1Byb2plY3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcbiAgICBuZXdQcm9qZWN0LmNsYXNzTGlzdC5hZGQoJ3Byb2plY3QtYnV0dG9uJyk7XG4gICAgXG4gICAgY29uc3QgYnV0dG9uVGV4dCA9ICdDcmVhdGUgTmV3IExpc3QnXG4gICAgY29uc3QgbmV3SWNvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICBuZXdJY29uLmNsYXNzTGlzdC5hZGQgKCdtYXRlcmlhbC1zeW1ib2xzLW91dGxpbmVkJywgJ2VkaXQnKTtcbiAgICBuZXdJY29uLnRleHRDb250ZW50ID0gJ2FkZCc7XG5cbiAgICBuZXdQcm9qZWN0LmFwcGVuZChuZXdJY29uLCBidXR0b25UZXh0KTtcbiAgICBwcm9qZWN0Q29udGFpbmVyLmFwcGVuZENoaWxkKG5ld1Byb2plY3QpO1xuICAgIG5ld1Byb2plY3QuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICBidG5BY3Rpb25zLnNob3dGb3JtKCdDcmVhdGUgTmV3IExpc3QnLCAncHJvamVjdCcpO1xuICAgIH0pO1xuICB9XG5cbiAgY29uc3QgZWRpdEFjdGlvbiA9IChtc2csIHR5cGUsIG5hbWUpID0+IHtcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbmFtZScpLnZhbHVlID0gbmFtZTtcbiAgICBidG5BY3Rpb25zLnNob3dGb3JtKG1zZywgdHlwZSwgbmFtZSk7XG4gIH1cblxuICBjb25zdCBlZGl0VG9kb0FjdGlvbiA9IChtc2csIHR5cGUsIHRvZG8pID0+IHtcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbmFtZScpLnZhbHVlID0gdG9kby5uYW1lO1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNkYXRlJykudmFsdWUgPSB0b2RvLmRhdGU7XG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3ByaW9yaXR5JykudmFsdWUgPSB0b2RvLnByaW9yaXR5O1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNwcm9qZWN0JykudmFsdWUgPSB0b2RvLnByb2plY3ROYW1lO1xuICAgIGJ0bkFjdGlvbnMuc2hvd0Zvcm0obXNnLCB0eXBlLCB0b2RvLm5hbWUpO1xuICB9XG5cbiAgLy9wcm9qZWN0IGZhY3RvcnkgZnVuY3Rpb25cbiAgY29uc3QgY3JlYXRlUHJvamVjdCA9IChuYW1lKSA9PiB7XG4gICAgcHJvamVjdExpc3QucHVzaChuYW1lKTtcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcInByb2plY3RMaXN0XCIsIEpTT04uc3RyaW5naWZ5KHByb2plY3RMaXN0KSk7XG5cbiAgICBwb3B1bGF0ZVByb2plY3REcm9wRG93bigpO1xuICAgIGRpc3BsYXlQcm9qZWN0KCk7XG4gICAgLy8gY3JlYXRlUHJvamVjdEFycmF5KCk7XG4gIH1cblxuICBjb25zdCB1cGRhdGVQcm9qZWN0ID0gKGN1cnJlbnROYW1lLCBuZXdOYW1lKSA9PiB7XG4gICAgbGV0IGluZGV4ID0gcHJvamVjdExpc3QuaW5kZXhPZihjdXJyZW50TmFtZSk7XG4gICAgcHJvamVjdExpc3RbaW5kZXhdID0gbmV3TmFtZTtcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcInByb2plY3RMaXN0XCIsIEpTT04uc3RyaW5naWZ5KHByb2plY3RMaXN0KSk7XG4gICAgZGlzcGxheVByb2plY3QoKTtcbiAgICBwb3B1bGF0ZVByb2plY3REcm9wRG93bigpO1xuICB9XG4gICAgICBcbiAgZGlzcGxheVByb2plY3QoKTtcbiAgcG9wdWxhdGVQcm9qZWN0RHJvcERvd24oKTtcbiAgXG4gIHJldHVybiB7Y3JlYXRlUHJvamVjdCwgcHJvamVjdExpc3QsIHVwZGF0ZVByb2plY3QsIGRpc3BsYXlQcm9qZWN0fVxufSkoKTsiLCJpbXBvcnQgeyBwcm9qZWN0U3R1ZmYgfSBmcm9tIFwiLi9wcm9qZWN0c1wiO1xuaW1wb3J0IHsgdG9Eb1N0dWZmIH0gZnJvbSBcIi4vdG9kb3NcIjtcblxuZXhwb3J0IGNvbnN0IGJ0bkFjdGlvbnMgPSAoKCkgPT4ge1xuICBjb25zdCB0b2RvQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFkZC10b2RvJyk7XG4gIGNvbnN0IGZvcm1NZXNzYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2Zvcm0tbWVzc2FnZScpO1xuICBjb25zdCBmb3JtQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmZvcm0tY29udGFpbmVyJyk7XG4gIGNvbnN0IHByb2plY3RDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvamVjdC1jb250YWluZXInKTtcbiAgXG4gIGNvbnN0IGRhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZGF0ZScpO1xuICBjb25zdCBwcmlvcml0eSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcmlvcml0eScpO1xuICBjb25zdCBwcm9qZWN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2plY3Qtc2VsZWN0Jyk7XG4gIGNvbnN0IHN1Ym1pdEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zdWJtaXQtYnRuJyk7XG4gIGNvbnN0IGNhbmNlbEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYW5jZWwtYnRuJyk7XG5cbiAgY29uc3Qgc2hvd0Zvcm0gPSAobXNnLCB0eXBlLCBjdXJyZW50KSA9PiB7XG4gICAgdG9kb0J0bi5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTtcbiAgICBwcm9qZWN0Q29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpO1xuICAgIGZvcm1NZXNzYWdlLnRleHRDb250ZW50ID0gbXNnO1xuICAgIGZvcm1Db250YWluZXIuY2xhc3NMaXN0LnJlbW92ZSgnaGlkZGVuJyk7XG4gICAgc3VibWl0QnRuLnRleHRDb250ZW50ID0gXCJTdWJtaXRcIjtcbiAgICBjYW5jZWxCdG4udGV4dENvbnRlbnQgPSBcIkNhbmNlbFwiO1xuXG4gICAgLy8gY2FuY2VsQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgICAvLyAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAvLyAgIGhpZGVGb3JtKCk7XG4gICAgLy8gfSk7XG5cbiAgICBpZiAodHlwZSA9PT0gJ3RvZG8nKSB7XG4gICAgICBzaG93Rm9ybUlucHV0cygpO1xuICAgICAgY29uc3QgY3VycmVudFByb2plY3RJbmRleCA9IHByb2plY3RTdHVmZi5wcm9qZWN0TGlzdC5pbmRleE9mKGN1cnJlbnQpO1xuICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3Byb2plY3QnKS52YWx1ZSA9IHByb2plY3RTdHVmZi5wcm9qZWN0TGlzdFtjdXJyZW50UHJvamVjdEluZGV4XTtcbiAgICAgIHN1Ym1pdEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG4gICAgICAgIGlmICh0b0RvU3R1ZmYudG9Eb3MuaW5jbHVkZXMoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI25hbWUnKSkpe1xuICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICB0b0RvU3R1ZmYuY3JlYXRlVG9kbyhkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbmFtZScpLnZhbHVlLCBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjZGF0ZScpLnZhbHVlLCBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjcHJpb3JpdHknKS52YWx1ZSwgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3Byb2plY3QnKS52YWx1ZSk7XG4gICAgICAgICAgaGlkZUZvcm0oJ3RvZG8nKTtcbiAgICAgICAgfSBlbHNlIHt9XG4gICAgICB9LCB7b25jZTogdHJ1ZX0pXG5cblxuICAgIH0gaWYgKHR5cGUgPT09ICdlZGl0IHRvZG8nKSB7XG4gICAgICBzaG93Rm9ybUlucHV0cygpO1xuICAgICAgc3VibWl0QnRuLnRleHRDb250ZW50ID0gXCJVcGRhdGVcIjtcbiAgICAgIHN1Ym1pdEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG4gICAgICAgIC8vIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdteUZvcm0nKS5jaGVja1ZhbGlkaXR5KCk7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgLy91cGRhdGUgdG9kbyBpdGVtXG4gICAgICAgIHRvRG9TdHVmZi51cGRhdGVUb2RvKGN1cnJlbnQsIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNuYW1lJykudmFsdWUsIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNkYXRlJykudmFsdWUsIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNwcmlvcml0eScpLnZhbHVlLCBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjcHJvamVjdCcpLnZhbHVlKTtcbiAgICAgICAgaGlkZUZvcm0oKTtcbiAgICAgIH0sIHtvbmNlOiB0cnVlfSk7XG5cbiAgICAgIGNhbmNlbEJ0bi50ZXh0Q29udGVudCA9IFwiRGVsZXRlXCI7XG4gICAgICBjYW5jZWxCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIC8vZGVsZXRlIHRvZG8gaXRlbVxuICAgICAgICBsZXQgaW5kZXggPSB0b0RvU3R1ZmYudG9Eb3MubWFwKGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgcmV0dXJuIGUubmFtZTtcbiAgICAgICAgfSkuaW5kZXhPZihjdXJyZW50KTtcbiAgICAgICAgdG9Eb1N0dWZmLnRvRG9zLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFwidG9Eb3NcIiwgSlNPTi5zdHJpbmdpZnkodG9Eb1N0dWZmLnRvRG9zKSk7XG4gICAgICAgIHByb2plY3RTdHVmZi5kaXNwbGF5UHJvamVjdCgpO1xuICAgICAgICBoaWRlRm9ybSgpO1xuICAgICAgfSwge29uY2U6IHRydWV9KTtcbiAgICB9IGlmICh0eXBlID09PSAncHJvamVjdCcpIHtcbiAgICAgIGhpZGVGb3JtSW5wdXRzKCk7XG4gICAgICBzdWJtaXRCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuICAgICAgICBjb25zb2xlLmxvZyghcHJvamVjdFN0dWZmLnByb2plY3RMaXN0LmluY2x1ZGVzKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNuYW1lJykudmFsdWUpKVxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGlmICghcHJvamVjdFN0dWZmLnByb2plY3RMaXN0LmluY2x1ZGVzKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNuYW1lJykudmFsdWUpKSB7XG4gICAgICAgICAgcHJvamVjdFN0dWZmLmNyZWF0ZVByb2plY3QoZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI25hbWUnKS52YWx1ZSk7XG4gICAgICAgICAgaGlkZUZvcm0oKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNvbnNvbGUubG9nKCdlcnJvcicpXG4gICAgICAgIH1cblxuICAgICAgICAgIFxuICAgICAgICBcbiAgICAgIH0pO1xuICAgIH0gaWYgKHR5cGUgPT09ICdlZGl0IHByb2plY3QnKSB7XG4gICAgICBoaWRlRm9ybUlucHV0cygpO1xuICAgICAgc3VibWl0QnRuLnRleHRDb250ZW50ID0gXCJVcGRhdGVcIjtcbiAgICAgIHN1Ym1pdEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG4gICAgICAgIC8vIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdteUZvcm0nKS5jaGVja1ZhbGlkaXR5KCk7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgcHJvamVjdFN0dWZmLnVwZGF0ZVByb2plY3QoY3VycmVudCwgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI25hbWUnKS52YWx1ZSk7XG4gICAgICAgIGhpZGVGb3JtKCk7XG4gICAgICB9LCB7b25jZTogdHJ1ZX0pO1xuXG4gICAgICBjYW5jZWxCdG4udGV4dENvbnRlbnQgPSBcIkRlbGV0ZVwiO1xuICAgICAgY2FuY2VsQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAvL2RlbGV0ZSB0b2RvIGl0ZW1cbiAgICAgICAgbGV0IGluZGV4ID0gcHJvamVjdFN0dWZmLnByb2plY3RMaXN0LmluZGV4T2YoY3VycmVudCk7XG4gICAgICAgIHByb2plY3RTdHVmZi5wcm9qZWN0TGlzdC5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcInByb2plY3RMaXN0XCIsIEpTT04uc3RyaW5naWZ5KHByb2plY3RTdHVmZi5wcm9qZWN0TGlzdCkpO1xuICAgICAgICBwcm9qZWN0U3R1ZmYuZGlzcGxheVByb2plY3QoKTtcbiAgICAgICAgaGlkZUZvcm0oKTtcbiAgICAgIH0sIHtvbmNlOiB0cnVlfSk7XG4gICAgfVxuICB9XG5cbiAgY29uc3Qgc2hvd0Zvcm1JbnB1dHMgPSAoKSA9PiB7XG4gICAgZGF0ZS5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTtcbiAgICBwcmlvcml0eS5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTtcbiAgICBwcm9qZWN0LmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpO1xuICB9XG5cbiAgY29uc3QgaGlkZUZvcm1JbnB1dHMgPSAoKSA9PiB7XG4gICAgZGF0ZS5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTtcbiAgICBwcmlvcml0eS5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTtcbiAgICBwcm9qZWN0LmNsYXNzTGlzdC5hZGQoJ2hpZGRlbicpO1xuICB9XG5cbiAgY29uc3QgaGlkZUZvcm0gPSAoKSA9PiB7XG4gICAgdG9kb0J0bi5jbGFzc0xpc3QucmVtb3ZlKCdoaWRkZW4nKTtcbiAgICBmb3JtTWVzc2FnZS50ZXh0Q29udGVudCA9IFwiXCI7XG4gICAgZm9ybUNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCdoaWRkZW4nKTtcbiAgICBwcm9qZWN0Q29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpO1xuICAgIC8vcmVzZXQgcHJpb3JpdHkgYW5kIHByb2plY3RcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjcHJpb3JpdHknKS5zZWxlY3RlZEluZGV4ID0gMDtcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjcHJvamVjdCcpLnNlbGVjdGVkSW5kZXggPSAwO1xuICAgIC8vcmVzZXQgaW5wdXRzXG4gICAgbGV0IGlucHV0cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2lucHV0Jyk7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpbnB1dHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlucHV0c1tpXS52YWx1ZSA9IFwiXCI7XG4gICAgfVxuICB9XG4gIFxuICByZXR1cm4ge3Nob3dGb3JtLCBoaWRlRm9ybX1cbn0pKCk7XG5cbiAgIl0sIm5hbWVzIjpbInRvRG9TdHVmZiIsInRvRG9zIiwiSlNPTiIsInBhcnNlIiwibG9jYWxTdG9yYWdlIiwiZ2V0SXRlbSIsImNyZWF0ZVRvZG8iLCJuYW1lIiwiZGF0ZSIsInByaW9yaXR5IiwicHJvamVjdE5hbWUiLCJ0b0RvIiwicHVzaCIsInNldEl0ZW0iLCJzdHJpbmdpZnkiLCJwcm9qZWN0U3R1ZmYiLCJkaXNwbGF5UHJvamVjdCIsImF0dGFjaFRvUHJvamVjdCIsInByb2plY3RMaXN0IiwiZm9yRWFjaCIsImUiLCJwcm9qZWN0QXJyYXkiLCJjcmVhdGVQcm9qZWN0IiwidXBkYXRlVG9kbyIsImN1cnJlbnQiLCJwcm9qZWN0IiwiaW5kZXgiLCJtYXAiLCJpbmRleE9mIiwicG9wdWxhdGVQcm9qZWN0RHJvcERvd24iLCJwcm9qZWN0U2VsZWN0IiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsImlubmVySFRNTCIsInByb2plY3RPcHRpb24iLCJjcmVhdGVFbGVtZW50Iiwic2V0QXR0cmlidXRlIiwiY2xhc3NMaXN0IiwiYWRkIiwidGV4dENvbnRlbnQiLCJhcHBlbmRDaGlsZCIsInByb2plY3RDb250YWluZXIiLCJxdWVyeVNlbGVjdG9yIiwicHJvamVjdERpdiIsImRhdGFzZXQiLCJyZXBsYWNlIiwidG9Mb3dlckNhc2UiLCJjbGFzc05hbWUiLCJlZGl0SWNvbiIsImFkZEV2ZW50TGlzdGVuZXIiLCJlZGl0QWN0aW9uIiwibmV3VG9kbyIsIm5ld0ljb24iLCJhcHBlbmQiLCJidG5BY3Rpb25zIiwic2hvd0Zvcm0iLCJ0IiwidG9Eb0l0ZW0iLCJjaGVja2JveCIsInRvRG9OYW1lIiwidG9Eb1ByaW9yaXR5IiwidG9Eb0RhdGUiLCJlZGl0VG9kb0FjdGlvbiIsIm5ld1Byb2plY3QiLCJtc2ciLCJ0eXBlIiwidmFsdWUiLCJ0b2RvIiwidXBkYXRlUHJvamVjdCIsImN1cnJlbnROYW1lIiwibmV3TmFtZSIsInRvZG9CdG4iLCJmb3JtTWVzc2FnZSIsImZvcm1Db250YWluZXIiLCJzdWJtaXRCdG4iLCJjYW5jZWxCdG4iLCJzaG93Rm9ybUlucHV0cyIsInJlbW92ZSIsImhpZGVGb3JtSW5wdXRzIiwiaGlkZUZvcm0iLCJzZWxlY3RlZEluZGV4IiwiaW5wdXRzIiwicXVlcnlTZWxlY3RvckFsbCIsImkiLCJsZW5ndGgiLCJjdXJyZW50UHJvamVjdEluZGV4IiwiaW5jbHVkZXMiLCJwcmV2ZW50RGVmYXVsdCIsIm9uY2UiLCJzcGxpY2UiLCJjb25zb2xlIiwibG9nIl0sInNvdXJjZVJvb3QiOiIifQ==